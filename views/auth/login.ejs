<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Đăng nhập hoặc đăng ký tài khoản Pet Helper">
    <title>
        <%= title %>
    </title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link rel="stylesheet" href="/stylesheets/auth.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="auth-page">
    <%- include('../partials/header') %>

        <main class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <img src="/images/logo.svg" alt="Pet Helper Logo" class="auth-logo">
                    <h1>Chào mừng đến Pet Helper</h1>
                    <p>Nền tảng hỗ trợ và bảo vệ vật nuôi</p>
                </div>

                <!-- Tab buttons -->
                <div class="auth-tabs">
                    <button
                        class="tab-btn <%= typeof activeTab !== 'undefined' && activeTab === 'register' ? '' : 'active' %>"
                        data-tab="login">
                        Đăng nhập
                    </button>
                    <button
                        class="tab-btn <%= typeof activeTab !== 'undefined' && activeTab === 'register' ? 'active' : '' %>"
                        data-tab="register">
                        Đăng ký
                    </button>
                </div>

                <!-- Error/Success messages -->
                <% if (error) { %>
                    <div class="alert alert-error">
                        <span>⚠️</span>
                        <%= error %>
                    </div>
                    <% } %>
                        <% if (success) { %>
                            <div class="alert alert-success">
                                <span>✅</span>
                                <%= success %>
                            </div>
                            <% } %>

                                <!-- Login Form -->
                                <form
                                    class="auth-form <%= typeof activeTab !== 'undefined' && activeTab === 'register' ? 'hidden' : '' %>"
                                    id="loginForm" action="/auth/login" method="POST">
                                    <div class="form-group">
                                        <label for="loginDisplayName">Tên đăng nhập</label>
                                        <input type="text" id="loginDisplayName" name="display_name"
                                            placeholder="Nhập tên đăng nhập" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="loginPassword">Mật khẩu</label>
                                        <input type="password" id="loginPassword" name="password"
                                            placeholder="Nhập mật khẩu" required>
                                    </div>

                                    <div class="form-options">
                                        <label class="checkbox-label">
                                            <input type="checkbox" name="remember"> Ghi nhớ đăng nhập
                                        </label>
                                        <a href="#" class="forgot-link">Quên mật khẩu?</a>
                                    </div>

                                    <button type="submit" class="btn btn-green btn-full">
                                        Đăng nhập
                                    </button>
                                </form>

                                <!-- Register Form -->
                                <form
                                    class="auth-form <%= typeof activeTab !== 'undefined' && activeTab === 'register' ? '' : 'hidden' %>"
                                    id="registerForm" action="/auth/register" method="POST">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="displayName">Tên hiển thị</label>
                                            <input type="text" id="displayName" name="display_name"
                                                placeholder="Tên hiển thị" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="fullName">Họ và tên</label>
                                            <input type="text" id="fullName" name="name" placeholder="Họ và tên đầy đủ"
                                                required>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="registerEmail">Email</label>
                                        <input type="email" id="registerEmail" name="email"
                                            placeholder="Nhập email của bạn" required>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="registerPassword">Mật khẩu</label>
                                            <input type="password" id="registerPassword" name="password"
                                                placeholder="Ít nhất 6 ký tự" required minlength="6">
                                        </div>
                                        <div class="form-group">
                                            <label for="confirmPassword">Xác nhận mật khẩu</label>
                                            <input type="password" id="confirmPassword" name="confirmPassword"
                                                placeholder="Nhập lại mật khẩu" required>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="birthday">Ngày sinh (không bắt buộc)</label>
                                        <input type="date" id="birthday" name="birthday">
                                    </div>

                                    <div class="form-group">
                                        <label for="address">Địa chỉ (không bắt buộc)</label>
                                        <input type="text" id="address" name="address" placeholder="Địa chỉ của bạn">
                                    </div>

                                    <div class="form-options">
                                        <label class="checkbox-label">
                                            <input type="checkbox" name="terms" required> Tôi đồng ý với <a
                                                href="#">điều khoản sử dụng</a>
                                        </label>
                                    </div>

                                    <button type="submit" class="btn btn-green btn-full">
                                        Đăng ký tài khoản
                                    </button>
                                </form>

                                <div class="auth-footer">
                                    <p>Hoặc đăng nhập với</p>
                                    <div class="social-login">
                                        <button type="button" class="social-btn google">
                                            <span>G</span> Google
                                        </button>
                                        <button type="button" class="social-btn facebook">
                                            <span>f</span> Facebook
                                        </button>
                                    </div>
                                </div>
            </div>
        </main>

        <%- include('../partials/footer') %>

            <script>
                // Tab switching
                const tabBtns = document.querySelectorAll('.tab-btn');
                const loginForm = document.getElementById('loginForm');
                const registerForm = document.getElementById('registerForm');

                tabBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tab = btn.dataset.tab;

                        // Update active tab
                        tabBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');

                        // Show/hide forms
                        if (tab === 'login') {
                            loginForm.classList.remove('hidden');
                            registerForm.classList.add('hidden');
                        } else {
                            loginForm.classList.add('hidden');
                            registerForm.classList.remove('hidden');
                        }
                    });
                });

                // Password confirmation validation
                const registerPasswordInput = document.getElementById('registerPassword');
                const confirmPasswordInput = document.getElementById('confirmPassword');

                confirmPasswordInput.addEventListener('input', () => {
                    if (registerPasswordInput.value !== confirmPasswordInput.value) {
                        confirmPasswordInput.setCustomValidity('Mật khẩu xác nhận không khớp');
                    } else {
                        confirmPasswordInput.setCustomValidity('');
                    }
                });
            </script>
</body>

</html>